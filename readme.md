# 介绍

**利用 PyTorch + Flask 搭建宠物图像识别服务**

# **实现思路**

## **数据采集和预处理**

** 首先通过 ** `<span class="ne-text">crawling.py</span>` 实现数据采集：

* **定义了28种不同的宠物类别，包括猫类、犬类、鸟类、鱼类等**
* **使用网络爬虫从必应图片搜索获取每种宠物150张图片**
* **将图片分为训练集(80%)和验证集(20%)**
* **创建了规范的目录结构：**`animal/train/` 和 `animal/val/`

## **训练模型**

**使用PyTorch框架构建和训练CNN模型 (**`classify.py`)：

1. **构建了一个3层卷积神经网络(CNN)：**

* **第一层：32个3x3卷积核**
* **第二层：64个3x3卷积核**
* **第三层：128个3x3卷积核**
* **全连接层：512个神经元**
* **输出层：对应28个宠物类别**

2. **数据预处理：**

* **图片大小统一调整为128x128**
* **使用随机裁剪增强数据**
* **进行标准化处理**

3. **训练过程：**

* **使用Adam优化器**
* **交叉熵损失函数**
* **训练50个epoch**
* **记录训练和测试的准确率、损失值**
* **保存训练好的模型到 **`animal_classification_model.pth`

## **实现预测 **

**实现了图片预测功能(**`predict.py`)：

* **加载训练好的模型**
* **对输入图片进行相同的预处理**
* **使用softmax获取预测概率**
* **返回前3个最可能的预测结果及其置信度**
* **支持API调用**

#### 7.4.1.4. **提供 Web API 接口**

**使用Flask框架提供REST API (**`api.py`)：

* **支持POST请求上传图片**
* **限制文件类型为png、jpg、jpeg**
* **调用预测模型**
* **返回JSON格式的预测结果**
* **自动清理临时文件**

# 相关文件

* crawling.py
  * 爬取需要的图片，并分类为训练集和测试集
* classify.py
  * 训练动物图像分类模型
* predict.py
  * 预测图片类型
* api.py
  * web接口实现，可以上传图片进行预测。formdata格式。
